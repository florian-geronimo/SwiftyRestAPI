# SwiftyRestAPI

SwiftyRestAPI is a in development project which generates swift files, SwiftyRestAPI is divided into two modules, Model Generator and API Generator.

## Table of contents

* [Team](#team)
* [Setup the project](#setup-the-project)
* [Running Swifty](#running-swifty)
* [Examples](#examples)

### Team

| Name  | Email | Role |
| ------------- | ------------- | ------------- |
| Daniel Lozano  | daniel@icalialabs.com  | Development |
| Jorge Elizondo  | jelizondo@icalialabs.com | Development |

## Development

### Setup the project

1. Clone this repository into your local machine.

  ```bash
  $ git clone git@github.com:IcaliaLabs/SwiftyRestAPI.git
  ```

2. Build the project.

  ```bash
  $ swift build -c release
  ```

3. Move the executable to the bin.

  ```bash
  $ cd .build/release
  $ cp -f SwiftyRestAPI /usr/local/bin/swifty
  ```

4. Now you have SwiftyRestAPI installed!!!

### Running Swifty

1. Run Swifty by typing in the terminal: `swifty`.

2. You will get an interactive prompt that will guide you the rest of the way.

### Current status

- SwiftyRestAPI is in ALPHA stage.
- It was built as a proof of concept to see if doing something like this was possible with Swift & Swift Package Manager.

#### Future Work
##### These next steps are crucial in order to get it to Beta level:

- Accept more input types (Postman, Paw, APIBlueprint, etc.)
  - [x] Postman
  - [ ] Paw
  - [ ] APIBlueprint
- Be able to generate more output types (Currently only supports Swift/Requestr generated code)
  - [x] Alamofire
  - [x] Swift codable models
- Be able to accept more Json Types. Nested dictionaries, arrays, and optionals, for example.
  - [x] Arrays
  - [ ] Nested dictionaries
  - [ ] Optionals

### Examples

#### API examples:

<details>
  <summary> API input example: </summary>
  <pre>
          {
            "categories" : [
              {
                "name" : "Users",
                "endpoints" : [
                  {
                    "urlParameters" : [

                    ],
                    "resourceName" : "User",
                    "isResourceArray" : false,
                    "name" : "getUser",
                    "method" : "GET",
                    "relativePath" : "\/users\/1"
                  },
                  {
                    "urlParameters" : [

                    ],
                    "resourceName" : "User",
                    "isResourceArray" : false,
                    "name" : "postUser",
                    "method" : "POST",
                    "relativePath" : "\/users\/1"
                  }
                ]
              },
              {
                "name" : "Places",
                "endpoints" : [
                  {
                    "urlParameters" : [

                    ],
                    "resourceName" : "Place",
                    "isResourceArray" : true,
                    "name" : "getPlaces",
                    "method" : "GET",
                    "relativePath" : "\/places"
                  },
                  {
                    "urlParameters" : [

                    ],
                    "resourceName" : "Place",
                    "isResourceArray" : false,
                    "name" : "postPlace",
                    "method" : "POST",
                    "relativePath" : "\/places\/1"
                  },
                  {
                    "urlParameters" : [

                    ],
                    "resourceName" : "Place",
                    "isResourceArray" : false,
                    "name" : "putPlace",
                    "method" : "PUT",
                    "relativePath" : "\/places\/1"
                  }
                ]
              }
            ],
            "basePath" : "http:\/\/www.icalialabs.com\/"
          }   
</details>


<details>
  <summary> API output example: </summary>
  <figure>
    <pre>
      //
      // Endpoints.swift
      // SwiftyRestAPI
      //
      // Autogenerated by SwifyRestAPI
      // Created with love by Icalia Labs
      //

      enum Endpoint {

          static let baseURL = "http://www.icalialabs.com/"

          case getUser
          case postUser
          case getPlaces
          case postPlace
          case putPlace

          var fullPath: String {
              let path: String
              switch self {
                  case .getUser:
                      path = "/users/1"
                  case .postUser:
                      path = "/users/1"
                  case .getPlaces:
                      path = "/places"
                  case .postPlace:
                      path = "/places/1"
                  case .putPlace:
                      path = "/places/1"
              }
              return Endpoint.baseURL + path
          }

      }
  </figure>
</details>

<details>
  <summary> API output example: </summary>
  <figure>
    <pre>
      //
      // UsersService.swift
      // SwiftyRestAPI
      //
      // Autogenerated by SwifyRestAPI
      // Created with love by Icalia Labs
      //

      import Foundation
      import Requestr

      protocol UsersService {

          func getUser(completion: @escaping (ApiResult<User>) -> Void)

          func postUser(completion: @escaping (ApiResult<User>) -> Void)

      }

      class UsersApiService {

          let apiClient: ApiClient

          init(apiClient: ApiClient) {
              self.apiClient = apiClient
          }

      }


      extension UsersApiService: UsersService {

          func getUser(completion: @escaping (ApiResult<User>) -> Void) {
              let endpoint = Endpoint.getUser
              apiClient.GET(endpoint.fullPath) { (result) in
                  completion(Result(apiResult: result))
              }
          }

          func postUser(completion: @escaping (ApiResult<User>) -> Void) {
              let endpoint = Endpoint.postUser
              apiClient.POST(endpoint.fullPath) { (result) in
                  completion(Result(apiResult: result))
              }
          }

      }
  </figure>
</details>

<details>
  <summary> API output example: </summary>
  <figure>
    <pre>
      // PlacesService.swift
      // SwiftyRestAPI
      //
      // Autogenerated by SwifyRestAPI
      // Created with love by Icalia Labs
      //

      import Foundation
      import Requestr

      protocol PlacesService {

          func getPlaces(completion: @escaping (ApiResult<[Place]>) -> Void)

          func postPlace(completion: @escaping (ApiResult<Place>) -> Void)

          func putPlace(completion: @escaping (ApiResult<Place>) -> Void)

      }

      class PlacesApiService {

          let apiClient: ApiClient

          init(apiClient: ApiClient) {
              self.apiClient = apiClient
          }

      }


      extension PlacesApiService: PlacesService {

          func getPlaces(completion: @escaping (ApiResult<[Place]>) -> Void) {
              let endpoint = Endpoint.getPlaces
              apiClient.GET(endpoint.fullPath) { (result) in
                  completion(Result(apiResult: result))
              }
          }

          func postPlace(completion: @escaping (ApiResult<Place>) -> Void) {
              let endpoint = Endpoint.postPlace
              apiClient.POST(endpoint.fullPath) { (result) in
                  completion(Result(apiResult: result))
              }
          }

          func putPlace(completion: @escaping (ApiResult<Place>) -> Void) {
              let endpoint = Endpoint.putPlace
              apiClient.PUT(endpoint.fullPath) { (result) in
                  completion(Result(apiResult: result))
              }
          }

      }
  </figure>
</details>

#### Models examples:

<details>
  <summary> Model input example </summary>
  <figure>
    <pre>
      {
        "firstName" : "Jorge",
        "age" : 22,
        "lastName" : "Elizondo",
        "isAdult" : true,
        "height" : 1.81
      }
  </figure>
</details>


<details>
  <summary> API output example: </summary>
  <figure>
    <pre>
      //
      // Person.swift
      // SwiftyRestAPI
      //
      // Autogenerated by SwifyRestAPI
      // Created with love by Icalia Labs
      //

      import Foundation
      import Requestr

      struct Person: JSONDeserializable {

          let lastName: String

          let age: Int

          let height: Double

          let firstName: String

          let isAdult: Bool

          init(json: JSONDictionary) throws {
              lastName = try json.decode("lastName")
              age = try json.decode("age")
              height = try json.decode("height")
              firstName = try json.decode("firstName")
              isAdult = try json.decode("isAdult")
          }

      }
  </figure>
</details>

<details>
  <summary> API output example: </summary>
  <figure>
    <pre>
      //
      // Person.swift
      // SwiftyRestAPI
      //
      // Autogenerated by SwifyRestAPI
      // Created with love by Icalia Labs
      //

      import Foundation

      struct Person: Codable {

          let lastName: String
          let age: Int
          let height: Double
          let firstName: String
          let isAdult: Bool

      }
  </figure>
</details>
